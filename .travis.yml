dist: xenial
language: ruby
before_install:
- "./spec/travis_build.sh > /dev/null 2>&1"
- export LD_FLAGS=-L$HOME/opt/lib
- export LD_LIBRARY_PATH=/lib:/usr/lib:/usr/local/lib:$HOME/opt/lib
- export CPATH=$CPATH:$HOME/opt/include
rvm:
- 2.3
- 2.4
- 2.5
- 2.6
cache: bundler

deploy:
  provider: script
  script: bash .vnops/rubygems/deploy.sh
  on:
    tags: true
    condition: $TRAVIS_TAG =~ ^v[0-9]
    rvm: 2.5

env:
  global:
  - RUBYGEMS_HOST=https://venuenext.jfrog.io/venuenext/api/gems/vn-release-gems
